<pre class="code">
<span class="srcline"><span class="lineno"><a href="126,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T80U3">maximums</span>, <span class="var type1" id="S3T81U4">foundRoots</span> ] = calculateMaximums( <span class="var type1" id="S4T82U7">startCoefficients</span>, <span class="var type2" id="S5T3V2U8">derivative</span>, <span class="var type1" id="S6T3U9">tf</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="126,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%UNTITLED5 Summary of this function goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   this function uses a 3X10 coefficient matrix and a derivative count to</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%   calculate the maximums of a given set of functions at a given</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%   derivative</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%calculate the Coefficient matrix for the given derivative</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,8" id="srcline8"> 8</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S7T3U12">it</span> = (<span class="mxinfo " id="T3:U7"><span class="mxinfo " id="T3:U8">1</span>:<span class="mxinfo " id="T3:U9">1</span>:<span class="var type1" id="S5T3U18">derivative</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="126,9" id="srcline9"> 9</a></span><span class="line">   <span class="mxinfo " id="T46:U11"><span class="mxinfo " id="T46:U12"><span class="var type1" id="S4T82U22">startCoefficients</span>(<span class="mxinfo " id="T14:U14">1</span>, <span class="mxinfo " id="T46:U15"><span class="mxinfo " id="T3:U16">1</span>:(<span class="mxinfo " id="T3:U17">10 - <span class="var type1" id="S7T3U29">it</span></span>)</span>)</span> = <span class="mxinfo " id="T46:U19">polyder(<span class="mxinfo " id="T47:U20"><span class="var type1" id="S4T82U33">startCoefficients</span>(<span class="mxinfo " id="T14:U22">1</span>, <span class="mxinfo " id="T47:U23"><span class="mxinfo " id="T3:U24">1</span>:(<span class="mxinfo " id="T3:U25">10 - (<span class="mxinfo " id="T3:U26"><span class="var type1" id="S7T3U42">it</span> - 1</span>)</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,10" id="srcline10">10</a></span><span class="line">   <span class="mxinfo " id="T46:U28"><span class="mxinfo " id="T46:U29"><span class="var type1" id="S4T82U47">startCoefficients</span>(<span class="mxinfo " id="T14:U31">2</span>, <span class="mxinfo " id="T46:U32"><span class="mxinfo " id="T3:U33">1</span>:(<span class="mxinfo " id="T3:U34">10 - <span class="var type1" id="S7T3U54">it</span></span>)</span>)</span> = <span class="mxinfo " id="T46:U36">polyder(<span class="mxinfo " id="T47:U37"><span class="var type1" id="S4T82U58">startCoefficients</span>(<span class="mxinfo " id="T14:U39">2</span>, <span class="mxinfo " id="T47:U40"><span class="mxinfo " id="T3:U41">1</span>:(<span class="mxinfo " id="T3:U42">10 - (<span class="mxinfo " id="T3:U43"><span class="var type1" id="S7T3U67">it</span> - 1</span>)</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,11" id="srcline11">11</a></span><span class="line">   <span class="mxinfo " id="T46:U45"><span class="mxinfo " id="T46:U46"><span class="var type1" id="S4T82U72">startCoefficients</span>(<span class="mxinfo " id="T14:U48">3</span>, <span class="mxinfo " id="T46:U49"><span class="mxinfo " id="T3:U50">1</span>:(<span class="mxinfo " id="T3:U51">10 - <span class="var type1" id="S7T3U79">it</span></span>)</span>)</span> = <span class="mxinfo " id="T46:U53">polyder(<span class="mxinfo " id="T47:U54"><span class="var type1" id="S4T82U83">startCoefficients</span>(<span class="mxinfo " id="T14:U56">3</span>, <span class="mxinfo " id="T47:U57"><span class="mxinfo " id="T3:U58">1</span>:(<span class="mxinfo " id="T3:U59">10 - (<span class="mxinfo " id="T3:U60"><span class="var type1" id="S7T3U92">it</span> - 1</span>)</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,12" id="srcline12">12</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,13" id="srcline13">13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,14" id="srcline14">14</a></span><span class="line"><span class="comment">%reset the size of coeffs</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T83:U62"><span class="var type1" id="S9T83U96">Coefficients</span> = <span class="mxinfo " id="T83:U64"><span class="var type1" id="S4T82U98">startCoefficients</span>(<span class="mxinfo " id="T10:U66">1:3</span>, <span class="mxinfo " id="T84:U67">1:(10 - <span class="var type1" id="S5T3U107">derivative</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,17" id="srcline17">17</a></span><span class="line"><span class="comment">%find the roots of the next derivative and combine them into a roots vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T57:U69"><span class="var type1" id="S10T57U110">rootsX</span> = <span class="mxinfo " id="T57:U71">roots(<span class="mxinfo " id="T46:U72">polyder(<span class="mxinfo " id="T49:U73"><span class="var type1" id="S9T83U116">Coefficients</span>(<span class="mxinfo " id="T14:U75">1</span>, <span class="mxinfo " id="T84:U76">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T57:U77"><span class="var type1" id="S12T57U121">rootsY</span> = <span class="mxinfo " id="T57:U79">roots(<span class="mxinfo " id="T46:U80">polyder(<span class="mxinfo " id="T49:U81"><span class="var type1" id="S9T83U127">Coefficients</span>(<span class="mxinfo " id="T14:U83">2</span>, <span class="mxinfo " id="T84:U84">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T57:U85"><span class="var type1" id="S13T57U132">rootsZ</span> = <span class="mxinfo " id="T57:U87">roots(<span class="mxinfo " id="T46:U88">polyder(<span class="mxinfo " id="T49:U89"><span class="var type1" id="S9T83U138">Coefficients</span>(<span class="mxinfo " id="T14:U91">3</span>, <span class="mxinfo " id="T84:U92">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,22" id="srcline22">22</a></span><span class="line"><span class="comment">%combine the roots together without repeating for optimization</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T81:U93"><span class="var type1" id="S3T81U143">foundRoots</span> = <span class="mxinfo " id="T81:U95">zeros(1, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T3:U96"><span class="var type1" id="S15T3U150">index</span> = <span class="mxinfo " id="T3:U98">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,25" id="srcline25">25</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S7T3U154">it</span> = (<span class="mxinfo " id="T3:U100"><span class="mxinfo " id="T3:U101">1</span>:<span class="mxinfo " id="T3:U102">1</span>:<span class="mxinfo " id="T3:U103">length(<span class="var type1" id="S10T57U162">rootsX</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="126,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T8:U105"><span class="keyword">if</span> <span class="mxinfo " id="T8:U106"><span class="mxinfo " id="T8:U107">isreal(<span class="mxinfo " id="T14:U108"><span class="var type1" id="S10T57U170">rootsX</span>(<span class="var type1" id="S7T3U171">it</span>)</span>)</span> &amp;&amp; <span class="var type0" id="S10T0U174">rootsX</span>(<span class="var type0" id="S7T0U175">it</span>) &lt;= <span class="var type0" id="S6T0U176">tf</span> &amp;&amp; <span class="var type0" id="S10T0U179">rootsX</span>(<span class="var type0" id="S7T0U180">it</span>) &gt;= 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,27" id="srcline27">27</a></span><span class="line">        <span class="keyword">if</span> ~any(~(<span class="var type0" id="S10T0U191">rootsX</span>(<span class="var type0" id="S7T0U192">it</span>) - <span class="var type0" id="S3T0U193">foundRoots</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="126,28" id="srcline28">28</a></span><span class="line">            <span class="comment">%fprintf('ADDED ROOT\n')</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,29" id="srcline29">29</a></span><span class="line">            <span class="var type0" id="S3T0U197">foundRoots</span>(<span class="var type0" id="S15T0U198">index</span>) = <span class="var type0" id="S10T0U200">rootsX</span>(<span class="var type0" id="S7T0U201">it</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="126,30" id="srcline30">30</a></span><span class="line">            <span class="var type0" id="S15T0U204">index</span> = <span class="var type0" id="S15T0U206">index</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="126,31" id="srcline31">31</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,32" id="srcline32">32</a></span><span class="line">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="126,33" id="srcline33">33</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,34" id="srcline34">34</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S7T3U210">it</span> = (<span class="mxinfo " id="T3:U112"><span class="mxinfo " id="T3:U113">1</span>:<span class="mxinfo " id="T3:U114">1</span>:<span class="mxinfo " id="T3:U115">length(<span class="var type1" id="S12T57U218">rootsY</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="126,35" id="srcline35">35</a></span><span class="line">    <span class="mxinfo " id="T8:U117"><span class="keyword">if</span> <span class="mxinfo " id="T8:U118"><span class="mxinfo " id="T8:U119">isreal(<span class="mxinfo " id="T14:U120"><span class="var type1" id="S12T57U226">rootsY</span>(<span class="var type1" id="S7T3U227">it</span>)</span>)</span> &amp;&amp; <span class="var type0" id="S12T0U230">rootsY</span>(<span class="var type0" id="S7T0U231">it</span>) &lt;= <span class="var type0" id="S6T0U232">tf</span> &amp;&amp; <span class="var type0" id="S12T0U235">rootsY</span>(<span class="var type0" id="S7T0U236">it</span>) &gt;= 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,36" id="srcline36">36</a></span><span class="line">        <span class="keyword">if</span> ~any(~(<span class="var type0" id="S12T0U247">rootsY</span>(<span class="var type0" id="S7T0U248">it</span>) - <span class="var type0" id="S3T0U249">foundRoots</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="126,37" id="srcline37">37</a></span><span class="line">            <span class="comment">%fprintf('ADDED ROOT\n')</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,38" id="srcline38">38</a></span><span class="line">            <span class="var type0" id="S3T0U253">foundRoots</span>(<span class="var type0" id="S15T0U254">index</span>) = <span class="var type0" id="S12T0U256">rootsY</span>(<span class="var type0" id="S7T0U257">it</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="126,39" id="srcline39">39</a></span><span class="line">            <span class="var type0" id="S15T0U260">index</span> = <span class="var type0" id="S15T0U262">index</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="126,40" id="srcline40">40</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,41" id="srcline41">41</a></span><span class="line">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="126,42" id="srcline42">42</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,43" id="srcline43">43</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S7T3U266">it</span> = (<span class="mxinfo " id="T3:U124"><span class="mxinfo " id="T3:U125">1</span>:<span class="mxinfo " id="T3:U126">1</span>:<span class="mxinfo " id="T3:U127">length(<span class="var type1" id="S13T57U274">rootsZ</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="126,44" id="srcline44">44</a></span><span class="line">    <span class="mxinfo " id="T8:U129"><span class="keyword">if</span> <span class="mxinfo " id="T8:U130"><span class="mxinfo " id="T8:U131">isreal(<span class="mxinfo " id="T14:U132"><span class="var type1" id="S13T57U282">rootsZ</span>(<span class="var type1" id="S7T3U283">it</span>)</span>)</span> &amp;&amp; <span class="var type0" id="S13T0U286">rootsZ</span>(<span class="var type0" id="S7T0U287">it</span>) &lt;= <span class="var type0" id="S6T0U288">tf</span> &amp;&amp; <span class="var type0" id="S13T0U291">rootsZ</span>(<span class="var type0" id="S7T0U292">it</span>) &gt;= 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,45" id="srcline45">45</a></span><span class="line">        <span class="keyword">if</span> ~any(~(<span class="var type0" id="S13T0U303">rootsZ</span>(<span class="var type0" id="S7T0U304">it</span>) - <span class="var type0" id="S3T0U305">foundRoots</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="126,46" id="srcline46">46</a></span><span class="line">            <span class="comment">%fprintf('ADDED ROOT\n')</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,47" id="srcline47">47</a></span><span class="line">            <span class="var type0" id="S3T0U309">foundRoots</span>(<span class="var type0" id="S15T0U310">index</span>) = <span class="var type0" id="S13T0U312">rootsZ</span>(<span class="var type0" id="S7T0U313">it</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="126,48" id="srcline48">48</a></span><span class="line">            <span class="var type0" id="S15T0U316">index</span> = <span class="var type0" id="S15T0U318">index</span> + 1;</span></span>
<span class="srcline"><span class="lineno"><a href="126,49" id="srcline49">49</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,50" id="srcline50">50</a></span><span class="line">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="126,51" id="srcline51">51</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,52" id="srcline52">52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,53" id="srcline53">53</a></span><span class="line"><span class="mxinfo " id="T80:U135"><span class="var type1" id="S2T80U322">maximums</span> = <span class="mxinfo " id="T80:U137">zeros(3, length(<span class="var type1" id="S3T81U329">foundRoots</span>) + 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,54" id="srcline54">54</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,55" id="srcline55">55</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S7T3U333">it</span> = (<span class="mxinfo " id="T3:U140"><span class="mxinfo " id="T3:U141">1</span>:<span class="mxinfo " id="T3:U142">1</span>:<span class="mxinfo " id="T3:U143">length(<span class="var type1" id="S3T81U341">foundRoots</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="126,56" id="srcline56">56</a></span><span class="line">    <span class="mxinfo " id="T85:U145"><span class="mxinfo " id="T85:U146"><span class="var type1" id="S2T80U345">maximums</span>(<span class="mxinfo " id="T10:U148">:</span>, <span class="var type1" id="S7T3U347">it</span>)</span> = <span class="mxinfo " id="T85:U150">[<span class="mxinfo " id="T3:U151">polyval(<span class="mxinfo " id="T49:U152"><span class="var type1" id="S9T83U353">Coefficients</span>(<span class="mxinfo " id="T14:U154">1</span>, <span class="mxinfo " id="T84:U155">:</span>)</span>, <span class="mxinfo " id="T3:U156"><span class="var type1" id="S3T81U357">foundRoots</span>(<span class="var type1" id="S7T3U358">it</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,57" id="srcline57">57</a></span><span class="line">        <span class="mxinfo " id="T3:U159">polyval(<span class="mxinfo " id="T49:U160"><span class="var type1" id="S9T83U363">Coefficients</span>(<span class="mxinfo " id="T14:U162">2</span>, <span class="mxinfo " id="T84:U163">:</span>)</span>, <span class="mxinfo " id="T3:U164"><span class="var type1" id="S3T81U367">foundRoots</span>(<span class="var type1" id="S7T3U368">it</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,58" id="srcline58">58</a></span><span class="line">        <span class="mxinfo " id="T3:U167">polyval(<span class="mxinfo " id="T49:U168"><span class="var type1" id="S9T83U373">Coefficients</span>(<span class="mxinfo " id="T14:U170">3</span>, <span class="mxinfo " id="T84:U171">:</span>)</span>, <span class="mxinfo " id="T3:U172"><span class="var type1" id="S3T81U377">foundRoots</span>(<span class="var type1" id="S7T3U378">it</span>)</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,59" id="srcline59">59</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,60" id="srcline60">60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,61" id="srcline61">61</a></span><span class="line"><span class="mxinfo " id="T85:U175"><span class="mxinfo " id="T85:U176"><span class="var type1" id="S2T80U382">maximums</span>(<span class="mxinfo " id="T10:U178">:</span>, <span class="mxinfo " id="T3:U179">length(<span class="var type1" id="S3T81U387">foundRoots</span>) + 1</span>)</span> = <span class="mxinfo " id="T85:U181">[<span class="mxinfo " id="T3:U182">polyval(<span class="mxinfo " id="T49:U183"><span class="var type1" id="S9T83U394">Coefficients</span>(<span class="mxinfo " id="T14:U185">1</span>, <span class="mxinfo " id="T84:U186">:</span>)</span>, <span class="var type1" id="S6T3U397">tf</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,62" id="srcline62">62</a></span><span class="line">        <span class="mxinfo " id="T3:U188">polyval(<span class="mxinfo " id="T49:U189"><span class="var type1" id="S9T83U402">Coefficients</span>(<span class="mxinfo " id="T14:U191">2</span>, <span class="mxinfo " id="T84:U192">:</span>)</span>, <span class="var type1" id="S6T3U405">tf</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,63" id="srcline63">63</a></span><span class="line">        <span class="mxinfo " id="T3:U194">polyval(<span class="mxinfo " id="T49:U195"><span class="var type1" id="S9T83U410">Coefficients</span>(<span class="mxinfo " id="T14:U197">3</span>, <span class="mxinfo " id="T84:U198">:</span>)</span>, <span class="var type1" id="S6T3U413">tf</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,64" id="srcline64">64</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,65" id="srcline65">65</a></span><span class="line"><span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,66" id="srcline66">66</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,67" id="srcline67">67</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,68" id="srcline68">68</a></span><span class="line"></span></span>
</pre>
