<pre class="code">
<span class="srcline"><span class="lineno"><a href="129,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T3U3">Error</span>] = calculateActuatorFeasibility(<span class="var type1" id="S3T75U6">Coefficients</span>, <span class="var type1" id="S4T3U7">Mass</span>, <span class="var type1" id="S5T7U8">Moment</span>, <span class="var type1" id="S6T3U9">MaxVel</span>, <span class="var type1" id="S7T3U10">MinZForce</span>, <span class="var type1" id="S8T3U11">MaxForce</span>, <span class="var type1" id="S9T3U12">MaxAngle</span>, <span class="var type1" id="S10T3U13">tf</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="129,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%UNTITLED4 Summary of this function goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%   This function will test a given set of polynomials to see if they fit</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%   within the actuator constraints specified</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%   ESSENTIALLY</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%   Coefficients: a 3X10 Matrix of coefficients</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%   Mass</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   Moment - moment vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   tf: the final time</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%MinZForce = the minumum force in the z direction typlically gravity (-45)</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,11" id="srcline11"> 11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%the distance of each motor from the center of mass</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo " id="T3:U11"><span class="var type1" id="S11T3U16">d</span> = <span class="mxinfo " id="T3:U13">0.4</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%coefficient of drag related to yaw drag</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo " id="T3:U14"><span class="var type1" id="S12T3U20">c</span> = <span class="mxinfo " id="T3:U16">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%gravity</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T3:U17"><span class="var type1" id="S13T3U24">g</span> = <span class="mxinfo " id="T3:U19">9.81</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%create the moment matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo  sgl" id="T73:U20"><span class="var type1 sgl" id="S14T73U28">J</span> = <span class="mxinfo " id="T73:U22">[<span class="mxinfo " id="T7:U23"><span class="mxinfo  sgl" id="T3:U24"><span class="var type1 sgl" id="S5T7U32">Moment</span>(<span class="mxinfo " id="T14:U26">1</span>)</span>,         <span class="mxinfo  sgl" id="T3:U27">0</span>,         <span class="mxinfo  sgl" id="T3:U28">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,20" id="srcline20"> 20</a></span><span class="line">            <span class="mxinfo " id="T7:U29"><span class="mxinfo  sgl" id="T3:U30">0</span>,          <span class="mxinfo  sgl" id="T3:U31"><span class="var type1 sgl" id="S5T7U39">Moment</span>(<span class="mxinfo " id="T14:U33">2</span>)</span>, <span class="mxinfo  sgl" id="T3:U34">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,21" id="srcline21"> 21</a></span><span class="line">            <span class="mxinfo " id="T7:U35"><span class="mxinfo  sgl" id="T3:U36">0</span>,          <span class="mxinfo  sgl" id="T3:U37">0</span>,         <span class="mxinfo  sgl" id="T3:U38"><span class="var type1 sgl" id="S5T7U46">Moment</span>(<span class="mxinfo " id="T14:U40">3</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">% Find the maximum accelerations</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,24" id="srcline24"> 24</a></span><span class="line"><span class="mxinfo  sgl" id="T73:U41">[<span class="var type1 sgl" id="S15T73U51">maxima</span>, <span class="var type1" id="S16T74U52">foundRoots</span>] = <span class="fcn" id="F819N3:B54">calculateMaximums</span>(<span class="var type1 sgl" id="S3T75U55">Coefficients</span>, 2, <span class="var type1 sgl" id="S10T3U57">tf</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%create the fTot</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo " id="T1:U46">[<span class="mxinfo " id="T3:U47">~</span>, <span class="var type1" id="S12T3U62">c</span>] = size(<span class="var type1" id="S16T74U65">foundRoots</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo  sgl" id="T99:U50"><span class="var type1 sgl" id="S19T99U68">f_total</span> = <span class="mxinfo  sgl" id="T99:U52">zeros(3, <span class="var type1" id="S12T3U72">c</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%now test whether these maximums are within feasible limits</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,30" id="srcline30"> 30</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T3U75">it</span> = (<span class="mxinfo " id="T3:U55"><span class="mxinfo " id="T3:U56">1</span>:<span class="mxinfo " id="T3:U57">length(<span class="var type1" id="S16T74U81">foundRoots</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="129,31" id="srcline31"> 31</a></span><span class="line">    <span class="comment">%calculate the magnitude of the acceleration gravity while taking into</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,32" id="srcline32"> 32</a></span><span class="line">    <span class="comment">%account mass and gravity</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,33" id="srcline33"> 33</a></span><span class="line">    <span class="comment">%mag is the [0, 0, 0, F_Total]' vector of the quadrotor. It must not</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,34" id="srcline34"> 34</a></span><span class="line">    <span class="comment">%exceed the maximum possible acceleration</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo  sgl" id="T78:U59"><span class="mxinfo  sgl" id="T78:U60"><span class="var type1 sgl" id="S19T99U85">f_total</span>(<span class="mxinfo " id="T10:U62">1:3</span>, <span class="var type1" id="S21T3U89">it</span>)</span> = <span class="mxinfo  sgl" id="T78:U64"><span class="var type1 sgl" id="S4T3U91">Mass</span> * (<span class="mxinfo  sgl" id="T78:U66"><span class="mxinfo " id="T78:U67"><span class="var type1" id="S15T73U95">maxima</span>(<span class="mxinfo " id="T10:U69">:</span>, <span class="var type1" id="S21T3U97">it</span>)</span> + [0; 0; <span class="var type1" id="S13T3U104">g</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,36" id="srcline36"> 36</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T8:U72"><span class="mxinfo  sgl" id="T3:U73">norm(<span class="mxinfo  sgl" id="T78:U74"><span class="var type1 sgl" id="S19T99U112">f_total</span>(<span class="mxinfo " id="T10:U76">:</span>, <span class="var type1" id="S21T3U114">it</span>)</span>)</span> &gt; <span class="var type1 sgl" id="S8T3U115">MaxForce</span></span> || <span class="mxinfo " id="T8:U79"><span class="mxinfo  sgl" id="T3:U80"><span class="var type1 sgl" id="S19T99U118">f_total</span>(<span class="mxinfo " id="T14:U82">3</span>, <span class="var type1" id="S21T3U120">it</span>)</span> &lt;= <span class="var type1 sgl" id="S7T3U121">MinZForce</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="129,37" id="srcline37"> 37</a></span><span class="line">        fprintf(<span class="string">'FORCE TOO HIGH\n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="129,38" id="srcline38"> 38</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U85"><span class="var type1 sgl" id="S2T3U128">Error</span> = <span class="mxinfo  sgl" id="T3:U87">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,39" id="srcline39"> 39</a></span><span class="line">        <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,40" id="srcline40"> 40</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,41" id="srcline41"> 41</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,42" id="srcline42"> 42</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">%now use a lot of physics and math to calculate the force each motor must</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%be exerting at each point</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%start by declaring the variables</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%inertial frame force vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo  sgl" id="T99:U88"><span class="var type1 sgl" id="S25T99U133">Fi</span> = <span class="mxinfo  sgl" id="T99:U90">zeros(3, length(<span class="var type1" id="S16T74U139">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,49" id="srcline49"> 49</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U92"><span class="mxinfo  sgl" id="T74:U93"><span class="var type1 sgl" id="S25T99U143">Fi</span>(<span class="mxinfo " id="T14:U95">1</span>, <span class="mxinfo " id="T100:U96">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U97"><span class="var type1 sgl" id="S4T3U147">Mass</span> * (<span class="mxinfo  sgl" id="T74:U99">polyval(<span class="mxinfo  sgl" id="T44:U100">polyder(<span class="mxinfo  sgl" id="T44:U101">polyder(<span class="mxinfo  sgl" id="T12:U102"><span class="var type1 sgl" id="S3T75U156">Coefficients</span>(<span class="mxinfo " id="T14:U104">1</span>, <span class="mxinfo " id="T101:U105">:</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U159">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U107"><span class="mxinfo  sgl" id="T74:U108"><span class="var type1 sgl" id="S25T99U163">Fi</span>(<span class="mxinfo " id="T14:U110">2</span>, <span class="mxinfo " id="T100:U111">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U112"><span class="var type1 sgl" id="S4T3U167">Mass</span> * (<span class="mxinfo  sgl" id="T74:U114">polyval(<span class="mxinfo  sgl" id="T44:U115">polyder(<span class="mxinfo  sgl" id="T44:U116">polyder(<span class="mxinfo  sgl" id="T12:U117"><span class="var type1 sgl" id="S3T75U176">Coefficients</span>(<span class="mxinfo " id="T14:U119">2</span>, <span class="mxinfo " id="T101:U120">:</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U179">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">% add g to the </span></span></span>
<span class="srcline"><span class="lineno"><a href="129,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U122"><span class="mxinfo  sgl" id="T74:U123"><span class="var type1 sgl" id="S25T99U183">Fi</span>(<span class="mxinfo " id="T14:U125">3</span>, <span class="mxinfo " id="T100:U126">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U127"><span class="var type1 sgl" id="S4T3U187">Mass</span> * (<span class="mxinfo  sgl" id="T74:U129"><span class="mxinfo  sgl" id="T74:U130">polyval(<span class="mxinfo  sgl" id="T44:U131">polyder(<span class="mxinfo  sgl" id="T44:U132">polyder(<span class="mxinfo  sgl" id="T12:U133"><span class="var type1 sgl" id="S3T75U197">Coefficients</span>(<span class="mxinfo " id="T14:U135">3</span>, <span class="mxinfo " id="T101:U136">:</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U200">foundRoots</span>)</span> + (<span class="var type1" id="S13T3U203">g</span> * ones(1, length(<span class="var type1" id="S16T74U209">foundRoots</span>)))</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,53" id="srcline53"> 53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">% create the first derivative of force vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo  sgl" id="T99:U140"><span class="var type1 sgl" id="S29T99U212">Fi_prime</span> = <span class="mxinfo  sgl" id="T99:U142">zeros(3, length(<span class="var type1" id="S16T74U218">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U144"><span class="mxinfo  sgl" id="T74:U145"><span class="var type1 sgl" id="S29T99U222">Fi_prime</span>(<span class="mxinfo " id="T14:U147">1</span>, <span class="mxinfo " id="T100:U148">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U149"><span class="var type1 sgl" id="S4T3U226">Mass</span> * (<span class="mxinfo  sgl" id="T74:U151">polyval(<span class="mxinfo  sgl" id="T44:U152">polyder(<span class="mxinfo  sgl" id="T44:U153">polyder(<span class="mxinfo  sgl" id="T44:U154">polyder(<span class="mxinfo  sgl" id="T12:U155"><span class="var type1 sgl" id="S3T75U237">Coefficients</span>(<span class="mxinfo " id="T14:U157">1</span>, <span class="mxinfo " id="T101:U158">:</span>)</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U240">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U160"><span class="mxinfo  sgl" id="T74:U161"><span class="var type1 sgl" id="S29T99U244">Fi_prime</span>(<span class="mxinfo " id="T14:U163">2</span>, <span class="mxinfo " id="T100:U164">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U165"><span class="var type1 sgl" id="S4T3U248">Mass</span> * (<span class="mxinfo  sgl" id="T74:U167">polyval(<span class="mxinfo  sgl" id="T44:U168">polyder(<span class="mxinfo  sgl" id="T44:U169">polyder(<span class="mxinfo  sgl" id="T44:U170">polyder(<span class="mxinfo  sgl" id="T12:U171"><span class="var type1 sgl" id="S3T75U259">Coefficients</span>(<span class="mxinfo " id="T14:U173">2</span>, <span class="mxinfo " id="T101:U174">:</span>)</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U262">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,58" id="srcline58"> 58</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U176"><span class="mxinfo  sgl" id="T74:U177"><span class="var type1 sgl" id="S29T99U266">Fi_prime</span>(<span class="mxinfo " id="T14:U179">3</span>, <span class="mxinfo " id="T100:U180">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U181"><span class="var type1 sgl" id="S4T3U270">Mass</span> * (<span class="mxinfo  sgl" id="T74:U183">polyval(<span class="mxinfo  sgl" id="T44:U184">polyder(<span class="mxinfo  sgl" id="T44:U185">polyder(<span class="mxinfo  sgl" id="T44:U186">polyder(<span class="mxinfo  sgl" id="T12:U187"><span class="var type1 sgl" id="S3T75U281">Coefficients</span>(<span class="mxinfo " id="T14:U189">3</span>, <span class="mxinfo " id="T101:U190">:</span>)</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U284">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">% create the first derivative of force vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo  sgl" id="T99:U192"><span class="var type1 sgl" id="S30T99U287">Fi_prime_prime</span> = <span class="mxinfo  sgl" id="T99:U194">zeros(3, length(<span class="var type1" id="S16T74U293">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U196"><span class="mxinfo  sgl" id="T74:U197"><span class="var type1 sgl" id="S30T99U297">Fi_prime_prime</span>(<span class="mxinfo " id="T14:U199">1</span>, <span class="mxinfo " id="T100:U200">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U201"><span class="var type1 sgl" id="S4T3U301">Mass</span> * (<span class="mxinfo  sgl" id="T74:U203">polyval(<span class="mxinfo  sgl" id="T44:U204">polyder(<span class="mxinfo  sgl" id="T44:U205">polyder(<span class="mxinfo  sgl" id="T44:U206">polyder(<span class="mxinfo  sgl" id="T44:U207">polyder(<span class="mxinfo  sgl" id="T12:U208"><span class="var type1 sgl" id="S3T75U314">Coefficients</span>(<span class="mxinfo " id="T14:U210">1</span>, <span class="mxinfo " id="T101:U211">:</span>)</span>)</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U317">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U213"><span class="mxinfo  sgl" id="T74:U214"><span class="var type1 sgl" id="S30T99U321">Fi_prime_prime</span>(<span class="mxinfo " id="T14:U216">2</span>, <span class="mxinfo " id="T100:U217">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U218"><span class="var type1 sgl" id="S4T3U325">Mass</span> * (<span class="mxinfo  sgl" id="T74:U220">polyval(<span class="mxinfo  sgl" id="T44:U221">polyder(<span class="mxinfo  sgl" id="T44:U222">polyder(<span class="mxinfo  sgl" id="T44:U223">polyder(<span class="mxinfo  sgl" id="T44:U224">polyder(<span class="mxinfo  sgl" id="T12:U225"><span class="var type1 sgl" id="S3T75U338">Coefficients</span>(<span class="mxinfo " id="T14:U227">2</span>, <span class="mxinfo " id="T101:U228">:</span>)</span>)</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U341">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo  sgl" id="T74:U230"><span class="mxinfo  sgl" id="T74:U231"><span class="var type1 sgl" id="S30T99U345">Fi_prime_prime</span>(<span class="mxinfo " id="T14:U233">3</span>, <span class="mxinfo " id="T100:U234">:</span>)</span> = <span class="mxinfo  sgl" id="T74:U235"><span class="var type1 sgl" id="S4T3U349">Mass</span> * (<span class="mxinfo  sgl" id="T74:U237">polyval(<span class="mxinfo  sgl" id="T44:U238">polyder(<span class="mxinfo  sgl" id="T44:U239">polyder(<span class="mxinfo  sgl" id="T44:U240">polyder(<span class="mxinfo  sgl" id="T44:U241">polyder(<span class="mxinfo  sgl" id="T12:U242"><span class="var type1 sgl" id="S3T75U362">Coefficients</span>(<span class="mxinfo " id="T14:U244">3</span>, <span class="mxinfo " id="T101:U245">:</span>)</span>)</span>)</span>)</span>)</span>, <span class="var type1 sgl" id="S16T74U365">foundRoots</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,65" id="srcline65"> 65</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%calculate the desired omega vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo " id="T99:U247"><span class="var type1" id="S31T99U368">Omega_desired</span> = <span class="mxinfo " id="T99:U249">zeros(3, length(<span class="var type1" id="S16T74U374">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%Aplha desired calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo " id="T99:U251"><span class="var type1" id="S32T99U377">Alpha_desired</span> = <span class="mxinfo " id="T99:U253">zeros(3, length(<span class="var type1" id="S16T74U383">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%Fi_bar_prime calc</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo " id="T99:U255"><span class="var type1" id="S33T99U386">Fi_bar_prime</span> = <span class="mxinfo " id="T99:U257">zeros(3, length(<span class="var type1" id="S16T74U392">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,72" id="srcline72"> 72</a></span><span class="line"><span class="comment">%Fi_bar_prime_prime calc</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo " id="T99:U259"><span class="var type1" id="S34T99U395">Fi_bar_prime_prime</span> = <span class="mxinfo " id="T99:U261">zeros(3, length(<span class="var type1" id="S16T74U401">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,74" id="srcline74"> 74</a></span><span class="line"><span class="comment">%create the bar vector of Fi</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,75" id="srcline75"> 75</a></span><span class="line"><span class="mxinfo " id="T99:U263"><span class="var type1" id="S35T99U404">Fi_bar</span> = <span class="mxinfo " id="T99:U265">zeros(3, length(<span class="var type1" id="S16T74U410">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%moments</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo " id="T99:U267"><span class="var type1" id="S36T99U413">Mb</span> = <span class="mxinfo " id="T99:U269">zeros(3, length(<span class="var type1" id="S16T74U419">foundRoots</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">%caclculate the bar and prime and alpha</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,80" id="srcline80"> 80</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T3U422">it</span> = (<span class="mxinfo " id="T3:U272"><span class="mxinfo " id="T3:U273">1</span>:<span class="mxinfo " id="T3:U274">1</span>:<span class="mxinfo " id="T3:U275">length(<span class="var type1" id="S16T74U430">foundRoots</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="129,81" id="srcline81"> 81</a></span><span class="line">    <span class="mxinfo " id="T3:U277"><span class="var type1" id="S37T3U433">mag</span> = <span class="mxinfo  sgl" id="T3:U279">norm(<span class="mxinfo  sgl" id="T78:U280"><span class="var type1 sgl" id="S25T99U437">Fi</span>(<span class="mxinfo " id="T10:U282">:</span>, <span class="var type1" id="S21T3U439">it</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,82" id="srcline82"> 82</a></span><span class="line">    <span class="mxinfo  sgl" id="T78:U284"><span class="mxinfo  sgl" id="T78:U285"><span class="var type1 sgl" id="S35T99U443">Fi_bar</span>(<span class="mxinfo " id="T10:U287">:</span>, <span class="var type1" id="S21T3U445">it</span>)</span> = <span class="mxinfo  sgl" id="T78:U289"><span class="mxinfo " id="T78:U290"><span class="var type1 sgl" id="S25T99U448">Fi</span>(<span class="mxinfo " id="T10:U292">:</span>, <span class="var type1" id="S21T3U450">it</span>)</span> / <span class="var type1" id="S37T3U451">mag</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,83" id="srcline83"> 83</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="129,84" id="srcline84"> 84</a></span><span class="line">    <span class="comment">%Calculation of fi_bar_prime</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo  sgl" id="T78:U295"><span class="mxinfo  sgl" id="T78:U296"><span class="var type1 sgl" id="S33T99U455">Fi_bar_prime</span>(<span class="mxinfo " id="T10:U298">:</span>, <span class="var type1" id="S21T3U457">it</span>)</span> = <span class="mxinfo  sgl" id="T78:U300">(<span class="mxinfo  sgl" id="T78:U301"><span class="mxinfo " id="T78:U302"><span class="var type1 sgl" id="S29T99U462">Fi_prime</span>(<span class="mxinfo " id="T10:U304">:</span>, <span class="var type1" id="S21T3U464">it</span>)</span> / <span class="mxinfo  sgl" id="T3:U306">norm(<span class="mxinfo  sgl" id="T78:U307"><span class="var type1 sgl" id="S25T99U468">Fi</span>(<span class="mxinfo " id="T10:U309">:</span>, <span class="var type1" id="S21T3U470">it</span>)</span>)</span></span>) - (<span class="mxinfo  sgl" id="T78:U311">(<span class="mxinfo  sgl" id="T78:U312"><span class="mxinfo " id="T78:U313"><span class="var type1 sgl" id="S25T99U476">Fi</span>(<span class="mxinfo " id="T10:U315">:</span>, <span class="var type1" id="S21T3U478">it</span>)</span> * (<span class="mxinfo  sgl" id="T3:U317"><span class="mxinfo " id="T7:U318"><span class="mxinfo " id="T78:U319"><span class="var type1 sgl" id="S25T99U483">Fi</span>(<span class="mxinfo " id="T10:U321">:</span>, <span class="var type1" id="S21T3U485">it</span>)</span>'</span> * <span class="mxinfo " id="T78:U323"><span class="var type1 sgl" id="S29T99U487">Fi_prime</span>(<span class="mxinfo " id="T10:U325">:</span>, <span class="var type1" id="S21T3U489">it</span>)</span></span>)</span>) / (<span class="mxinfo  sgl" id="T3:U327"><span class="mxinfo  sgl" id="T3:U328">norm(<span class="mxinfo  sgl" id="T78:U329"><span class="var type1 sgl" id="S25T99U495">Fi</span>(<span class="mxinfo " id="T10:U331">:</span>, <span class="var type1" id="S21T3U497">it</span>)</span>)</span>^3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,86" id="srcline86"> 86</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="129,87" id="srcline87"> 87</a></span><span class="line">    <span class="comment">% calcing fi_bar_prime_prime</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,88" id="srcline88"> 88</a></span><span class="line">    <span class="mxinfo  sgl" id="T78:U333"><span class="mxinfo  sgl" id="T78:U334"><span class="var type1 sgl" id="S34T99U502">Fi_bar_prime_prime</span>(<span class="mxinfo " id="T10:U336">:</span>, <span class="var type1" id="S21T3U504">it</span>)</span> = <span class="mxinfo  sgl" id="T78:U338"><span class="mxinfo  sgl" id="T78:U339">(<span class="mxinfo  sgl" id="T78:U340"><span class="mxinfo " id="T78:U341"><span class="var type1 sgl" id="S30T99U510">Fi_prime_prime</span>(<span class="mxinfo " id="T10:U343">:</span>, <span class="var type1" id="S21T3U512">it</span>)</span> / <span class="mxinfo  sgl" id="T3:U345">norm(<span class="mxinfo  sgl" id="T78:U346"><span class="var type1 sgl" id="S25T99U516">Fi</span>(<span class="mxinfo " id="T10:U348">:</span>, <span class="var type1" id="S21T3U518">it</span>)</span>)</span></span>) - (<span class="mxinfo  sgl" id="T78:U350">(<span class="mxinfo  sgl" id="T78:U351"><span class="mxinfo  sgl" id="T78:U352"><span class="mxinfo  sgl" id="T78:U353"><span class="mxinfo  sgl" id="T78:U354">2 * <span class="mxinfo " id="T78:U355"><span class="var type1 sgl" id="S29T99U528">Fi_prime</span>(<span class="mxinfo " id="T10:U357">:</span>, <span class="var type1" id="S21T3U530">it</span>)</span></span> * (<span class="mxinfo  sgl" id="T3:U359"><span class="mxinfo " id="T7:U360"><span class="mxinfo " id="T78:U361"><span class="var type1 sgl" id="S25T99U535">Fi</span>(<span class="mxinfo " id="T10:U363">:</span>, <span class="var type1" id="S21T3U537">it</span>)</span>'</span> * <span class="mxinfo " id="T78:U365"><span class="var type1 sgl" id="S29T99U539">Fi_prime</span>(<span class="mxinfo " id="T10:U367">:</span>, <span class="var type1" id="S21T3U541">it</span>)</span></span>)</span> + <span class="mxinfo  sgl" id="T78:U369"><span class="mxinfo " id="T78:U370"><span class="var type1 sgl" id="S25T99U544">Fi</span>(<span class="mxinfo " id="T10:U372">:</span>, <span class="var type1" id="S21T3U546">it</span>)</span> * (<span class="mxinfo  sgl" id="T3:U374"><span class="mxinfo " id="T7:U375"><span class="mxinfo " id="T78:U376"><span class="var type1 sgl" id="S29T99U551">Fi_prime</span>(<span class="mxinfo " id="T10:U378">:</span>, <span class="var type1" id="S21T3U553">it</span>)</span>'</span> * <span class="mxinfo " id="T78:U380"><span class="var type1 sgl" id="S29T99U555">Fi_prime</span>(<span class="mxinfo " id="T10:U382">:</span>, <span class="var type1" id="S21T3U557">it</span>)</span></span>)</span></span> + <span class="mxinfo  sgl" id="T78:U384"><span class="mxinfo " id="T78:U385"><span class="var type1 sgl" id="S25T99U560">Fi</span>(<span class="mxinfo " id="T10:U387">:</span>, <span class="var type1" id="S21T3U562">it</span>)</span> * (<span class="mxinfo  sgl" id="T3:U389"><span class="mxinfo " id="T7:U390"><span class="mxinfo " id="T78:U391"><span class="var type1 sgl" id="S25T99U567">Fi</span>(<span class="mxinfo " id="T10:U393">:</span>, <span class="var type1" id="S21T3U569">it</span>)</span>'</span> * <span class="mxinfo " id="T78:U395"><span class="var type1 sgl" id="S30T99U571">Fi_prime_prime</span>(<span class="mxinfo " id="T10:U397">:</span>, <span class="var type1" id="S21T3U573">it</span>)</span></span>)</span></span>) / <span class="mxinfo  sgl" id="T3:U399"><span class="mxinfo  sgl" id="T3:U400">norm(<span class="mxinfo  sgl" id="T78:U401"><span class="var type1 sgl" id="S25T99U578">Fi</span>(<span class="mxinfo " id="T10:U403">:</span>, <span class="var type1" id="S21T3U580">it</span>)</span>)</span>^3</span></span>)</span> + (<span class="mxinfo  sgl" id="T78:U405">(<span class="mxinfo  sgl" id="T78:U406"><span class="mxinfo  sgl" id="T78:U407">3 * <span class="mxinfo " id="T78:U408"><span class="var type1 sgl" id="S25T99U589">Fi</span>(<span class="mxinfo " id="T10:U410">:</span>, <span class="var type1" id="S21T3U591">it</span>)</span></span> * (<span class="mxinfo  sgl" id="T3:U412"><span class="mxinfo " id="T7:U413"><span class="mxinfo " id="T78:U414"><span class="var type1 sgl" id="S25T99U596">Fi</span>(<span class="mxinfo " id="T10:U416">:</span>, <span class="var type1" id="S21T3U598">it</span>)</span>'</span> * <span class="mxinfo " id="T78:U418"><span class="var type1 sgl" id="S29T99U600">Fi_prime</span>(<span class="mxinfo " id="T10:U420">:</span>, <span class="var type1" id="S21T3U602">it</span>)</span></span>)</span>) / <span class="mxinfo  sgl" id="T3:U422"><span class="mxinfo  sgl" id="T3:U423">norm(<span class="mxinfo  sgl" id="T78:U424"><span class="var type1 sgl" id="S25T99U607">Fi</span>(<span class="mxinfo " id="T10:U426">:</span>, <span class="var type1" id="S21T3U609">it</span>)</span>)</span>^5</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,89" id="srcline89"> 89</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="129,90" id="srcline90"> 90</a></span><span class="line">    <span class="comment">%the omega desired calc</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,91" id="srcline91"> 91</a></span><span class="line">    <span class="mxinfo  sgl" id="T78:U428"><span class="mxinfo  sgl" id="T78:U429"><span class="var type1 sgl" id="S31T99U614">Omega_desired</span>(<span class="mxinfo " id="T10:U431">:</span>, <span class="var type1" id="S21T3U616">it</span>)</span> = <span class="mxinfo  sgl" id="T78:U433">cross(<span class="mxinfo " id="T78:U434"><span class="var type1 sgl" id="S35T99U620">Fi_bar</span>(<span class="mxinfo " id="T10:U436">:</span>, <span class="var type1" id="S21T3U622">it</span>)</span>, <span class="mxinfo " id="T78:U438"><span class="var type1 sgl" id="S33T99U624">Fi_bar_prime</span>(<span class="mxinfo " id="T10:U440">:</span>, <span class="var type1" id="S21T3U626">it</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,92" id="srcline92"> 92</a></span><span class="line">    <span class="comment">%set the z moment to zero</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo  sgl" id="T3:U442"><span class="mxinfo  sgl" id="T3:U443"><span class="var type1 sgl" id="S31T99U630">Omega_desired</span>(<span class="mxinfo " id="T14:U445">3</span>, <span class="var type1" id="S21T3U632">it</span>)</span> = <span class="mxinfo  sgl" id="T3:U447">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,94" id="srcline94"> 94</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="129,95" id="srcline95"> 95</a></span><span class="line">    <span class="comment">%the alpha vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo  sgl" id="T78:U448"><span class="mxinfo  sgl" id="T78:U449"><span class="var type1 sgl" id="S32T99U637">Alpha_desired</span>(<span class="mxinfo " id="T10:U451">:</span>, <span class="var type1" id="S21T3U639">it</span>)</span> = <span class="mxinfo  sgl" id="T78:U453">cross(<span class="mxinfo " id="T78:U454"><span class="var type1 sgl" id="S35T99U643">Fi_bar</span>(<span class="mxinfo " id="T10:U456">:</span>, <span class="var type1" id="S21T3U645">it</span>)</span>, (<span class="mxinfo  sgl" id="T78:U458"><span class="mxinfo " id="T78:U459"><span class="var type1 sgl" id="S34T99U649">Fi_bar_prime_prime</span>(<span class="mxinfo " id="T10:U461">:</span>, <span class="var type1" id="S21T3U651">it</span>)</span> - <span class="mxinfo  sgl" id="T78:U463">cross(<span class="mxinfo " id="T78:U464"><span class="var type1 sgl" id="S31T99U655">Omega_desired</span>(<span class="mxinfo " id="T10:U466">:</span>, <span class="var type1" id="S21T3U657">it</span>)</span>, (<span class="mxinfo  sgl" id="T78:U468">cross(<span class="mxinfo " id="T78:U469"><span class="var type1 sgl" id="S31T99U662">Omega_desired</span>(<span class="mxinfo " id="T10:U471">:</span>, <span class="var type1" id="S21T3U664">it</span>)</span>, <span class="mxinfo " id="T78:U473"><span class="var type1 sgl" id="S33T99U666">Fi_bar_prime</span>(<span class="mxinfo " id="T10:U475">:</span>, <span class="var type1" id="S21T3U668">it</span>)</span>)</span>))</span></span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,97" id="srcline97"> 97</a></span><span class="line">    <span class="comment">%set the z to zero</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,98" id="srcline98"> 98</a></span><span class="line">    <span class="mxinfo  sgl" id="T3:U477"><span class="mxinfo  sgl" id="T3:U478"><span class="var type1 sgl" id="S32T99U672">Alpha_desired</span>(<span class="mxinfo " id="T14:U480">3</span>, <span class="var type1" id="S21T3U674">it</span>)</span> = <span class="mxinfo  sgl" id="T3:U482">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,99" id="srcline99"> 99</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="129,100" id="srcline100">100</a></span><span class="line">    <span class="comment">%FINALLY! now that we have the desired omega and the simulated current</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,101" id="srcline101">101</a></span><span class="line">    <span class="comment">%omega, we can calcuate the exact forces that each motor must produce at a</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,102" id="srcline102">102</a></span><span class="line">    <span class="comment">%given time(the maximum accelerations along a polynomial)</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,103" id="srcline103">103</a></span><span class="line">    <span class="mxinfo  sgl" id="T78:U483"><span class="mxinfo  sgl" id="T78:U484"><span class="var type1 sgl" id="S36T99U679">Mb</span>(<span class="mxinfo " id="T10:U486">:</span>, <span class="var type1" id="S21T3U681">it</span>)</span> = <span class="mxinfo  sgl" id="T78:U488"><span class="mxinfo  sgl" id="T78:U489"><span class="var type1 sgl" id="S14T73U684">J</span> * <span class="mxinfo " id="T78:U491"><span class="var type1 sgl" id="S32T99U686">Alpha_desired</span>(<span class="mxinfo " id="T10:U493">:</span>, <span class="var type1" id="S21T3U688">it</span>)</span></span> + <span class="mxinfo  sgl" id="T78:U495">cross(<span class="mxinfo " id="T78:U496"><span class="var type1 sgl" id="S31T99U692">Omega_desired</span>(<span class="mxinfo " id="T10:U498">:</span>, <span class="var type1" id="S21T3U694">it</span>)</span>, <span class="mxinfo  sgl" id="T78:U500"><span class="var type1 sgl" id="S14T73U696">J</span> * <span class="mxinfo " id="T78:U502"><span class="var type1 sgl" id="S31T99U698">Omega_desired</span>(<span class="mxinfo " id="T10:U504">:</span>, <span class="var type1" id="S21T3U700">it</span>)</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,104" id="srcline104">104</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,105" id="srcline105">105</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo  sgl" id="T102:U506"><span class="var type1 sgl" id="S39T102U703">motorForces</span> = <span class="mxinfo  sgl" id="T102:U508">zeros(4, length(<span class="var type1" id="S36T99U709">Mb</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,107" id="srcline107">107</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo " id="T95:U510"><span class="var type1" id="S40T95U712">torqueMat</span> = <span class="mxinfo " id="T95:U512">[1, 1,  1,  1;</span></span>
<span class="srcline"><span class="lineno"><a href="129,109" id="srcline109">109</a></span><span class="line">             <span class="var type1" id="S11T3U720">d</span>, 0, -<span class="var type1" id="S11T3U723">d</span>,  0;</span></span>
<span class="srcline"><span class="lineno"><a href="129,110" id="srcline110">110</a></span><span class="line">             0, <span class="var type1" id="S11T3U727">d</span>,  0, -<span class="var type1" id="S11T3U730">d</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,111" id="srcline111">111</a></span><span class="line">            -<span class="var type1" id="S12T3U733">c</span>, <span class="var type1" id="S12T3U734">c</span>, -<span class="var type1" id="S12T3U736">c</span>,  <span class="var type1" id="S12T3U737">c</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,112" id="srcline112">112</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="129,113" id="srcline113">113</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T3U740">it</span> = (<span class="mxinfo " id="T3:U522"><span class="mxinfo " id="T3:U523">1</span>:<span class="mxinfo " id="T3:U524">1</span>:<span class="mxinfo " id="T3:U525">length(<span class="var type1" id="S16T74U748">foundRoots</span>)</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="129,114" id="srcline114">114</a></span><span class="line">    <span class="mxinfo  sgl" id="T96:U527"><span class="mxinfo  sgl" id="T96:U528"><span class="var type1 sgl" id="S39T102U752">motorForces</span>(<span class="mxinfo " id="T103:U530">:</span>, <span class="var type1" id="S21T3U754">it</span>)</span> = <span class="mxinfo  dbl sgl" id="T96:U532"><span class="var type1" id="S40T95U756">torqueMat</span> \ <span class="mxinfo  sgl" id="T96:U534">[<span class="mxinfo  sgl" id="T3:U535">norm(<span class="mxinfo  sgl" id="T78:U536"><span class="var type1 sgl" id="S19T99U762">f_total</span>(<span class="mxinfo " id="T10:U538">:</span>, <span class="var type1" id="S21T3U764">it</span>)</span>)</span>; <span class="mxinfo  sgl" id="T3:U540"><span class="var type1 sgl" id="S36T99U767">Mb</span>(<span class="mxinfo " id="T14:U542">1</span>, <span class="var type1" id="S21T3U769">it</span>)</span>; <span class="mxinfo  sgl" id="T3:U544"><span class="var type1 sgl" id="S36T99U772">Mb</span>(<span class="mxinfo " id="T14:U546">2</span>, <span class="var type1" id="S21T3U774">it</span>)</span>; <span class="mxinfo  sgl" id="T3:U548"><span class="var type1 sgl" id="S36T99U777">Mb</span>(<span class="mxinfo " id="T14:U550">3</span>, <span class="var type1" id="S21T3U779">it</span>)</span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,115" id="srcline115">115</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="129,116" id="srcline116">116</a></span><span class="line">    <span class="comment">% while in the for loop check to see if the forces are within the</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,117" id="srcline117">117</a></span><span class="line">    <span class="comment">% bounds</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,118" id="srcline118">118</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="129,119" id="srcline119">119</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T8:U552">any(<span class="mxinfo  sgl" id="T97:U553"><span class="mxinfo " id="T96:U554"><span class="var type1 sgl" id="S39T102U787">motorForces</span>(<span class="mxinfo " id="T103:U556">:</span>, <span class="var type1" id="S21T3U789">it</span>)</span> &lt;= <span class="mxinfo  sgl" id="T3:U558">1</span></span>)</span> || <span class="mxinfo " id="T8:U559">any(<span class="mxinfo  sgl" id="T97:U560"><span class="mxinfo " id="T96:U561"><span class="var type1 sgl" id="S39T102U795">motorForces</span>(<span class="mxinfo " id="T103:U563">:</span>, <span class="var type1" id="S21T3U797">it</span>)</span> &gt;= <span class="mxinfo  sgl" id="T3:U565"><span class="var type1 sgl" id="S8T3U799">MaxForce</span> / 4</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,120" id="srcline120">120</a></span><span class="line">        fprintf(<span class="string">'INDIVIDUAL MOTOR FORCE TOO HIGH\n'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="129,121" id="srcline121">121</a></span><span class="line">        <span class="mxinfo  sgl" id="T3:U567"><span class="var type1 sgl" id="S2T3U807">Error</span> = <span class="mxinfo  sgl" id="T3:U569">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,122" id="srcline122">122</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,123" id="srcline123">123</a></span><span class="line">    <span class="keyword">end</span>    </span></span>
<span class="srcline"><span class="lineno"><a href="129,124" id="srcline124">124</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,125" id="srcline125">125</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,126" id="srcline126">126</a></span><span class="line"><span class="comment">%IF YOU HAVE NOT RETURNED BY THIS POINT THE TRAJECTORY IS WITHIN FEASIBLE</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,127" id="srcline127">127</a></span><span class="line"><span class="comment">%LIMITS</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo  sgl" id="T3:U570"><span class="var type1 sgl" id="S2T3U812">Error</span> = <span class="mxinfo  sgl" id="T3:U572">-<span class="mxinfo " id="T3:U573">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,129" id="srcline129">129</a></span><span class="line"><span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="129,130" id="srcline130">130</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="129,131" id="srcline131">131</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="129,132" id="srcline132">132</a></span><span class="line"></span></span>
</pre>
